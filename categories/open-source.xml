<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:ns0="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Random Thoughts (open-source)</title><link>https://carreau.github.io/</link><description /><ns0:link href="https://carreau.github.io/categories/open-source.xml" rel="self" type="application/rss+xml" /><language>en</language><lastBuildDate>Thu, 11 Oct 2018 01:34:22 GMT</lastBuildDate><generator>https://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>The Pleasure of deleting code</title><link>https://carreau.github.io/posts/34-the-pleasure-of-deleting-code.md.html</link><dc:creator>Matthias Bussonnier</dc:creator><description>&lt;div&gt;&lt;h2 id="good-code-is-deleted-code"&gt;Good Code is Deleted Code&lt;/h2&gt;
&lt;p&gt;The only code without bugs is &lt;a href="https://github.com/kelseyhightower/nocode"&gt;no
code&lt;/a&gt;. And the less code you have,
the less mental load as well. This is why it is often a pleasure to delete a lot
of code. &lt;/p&gt;
&lt;p&gt;In IPython we recently bumped the version number to 7.0 and &lt;a href="https://github.com/ipython/ipython/pull/10833"&gt;dropped support for
Python 3.3&lt;/a&gt;. This was the
occasion to clean, and remove a lots of code that insure compatibility with
multiple minor Python version, and while it may seem easy it required a lot of
thinking ahead of time to make the process simple. &lt;/p&gt;
&lt;h3 id="finding-what-can-and-should-be-deleted"&gt;Finding what can (and should be deleted)&lt;/h3&gt;
&lt;p&gt;The hardest part is not deleting the code itself, but finding what can be
deleted. In many compiled languages, the compiler may help you, but with Python
it can be quite tougher, and some of Python usual practices make it harder.&lt;/p&gt;
&lt;p&gt;Here are a few tips on how to prepare your code (when you write it) for
deletion. &lt;/p&gt;
&lt;h4 id="eafp-vs-lbyl"&gt;EAFP vs LBYL&lt;/h4&gt;
&lt;p&gt;Python tend to be more on the Easier to ask Forgiveness than Permission, than
Look Before You Leap. It is thus common to see &lt;a href="https://github.com/ipython/ipython/issues/11068"&gt;code like&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;try: 
     from importlib import reload 
except ImportError : 
     from imp import reload
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In this particular case though, why do we use the try/except ? Unless there is
a comment attached, it is hard guess that &lt;code&gt;from imp import reload&lt;/code&gt; was
deprecated since python 3.4, the comment can easily get out of sync with the
actual code. &lt;/p&gt;
&lt;p&gt;A better way would be to explicitly check &lt;code&gt;sys.version_info&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if sys.version_info &amp;lt; (3, 4):
     from imp import reload 
else:
     from importlib import reload
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(Note, tuple from unequal length can be compared in python). &lt;/p&gt;
&lt;p&gt;It is now obvious which code should be removed and when. You can see that as
"Explicit is better than implicit" rule. &lt;/p&gt;
&lt;h3 id="deprecated-code"&gt;Deprecated code&lt;/h3&gt;
&lt;p&gt;Removing legacy deprecated code is also always a challenge, as you may be
worried of other library might be still relying deprecation. To help with that
let's see how we can improve typical deprecation, here is a typical deprecated
method from IPython::&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;def unicode_std_stream(stream='stdout'):
    """DEPRECATED"""
    warn("IPython.utils.io.unicode_std_stream is deprecated", DeprecationWarning)
    ...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;How much are you confident you can remove this ? A few question should pop into
your head:
  - Since when has this function been deprecated ? &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;def unicode_std_stream(stream='stdout'):
    """DEPRECATED"""
    warn("IPython.utils.io.unicode_std_stream is deprecated since IPython 4.0", DeprecationWarning)
    ...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;With this new snippet I'm confident it's been 3 versions and I am more willing
to delete. This also helps downstream libraries to know whether they need
conditional code or now. I'm still unsure downstream maintainer have updated
their code. Let's add a stacklevel (to help them find where the deprecated
function is used, and add more informations about how they can replace code uses
this function:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;def unicode_std_stream(stream='stdout'):
    """DEPRECATED, moved to nbconvert.utils.io"""
    warn("IPython.utils.io.unicode_std_stream has moved to nbconvert.utils.io since IPython 4.0", DeprecationWarning, stacklevel=2)
    ...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Well with this information I'm even more confident downstream maintainer have
updated their code. They have an actionable item: replace one import for
another, and are more likely to do that, than dig for 1h in history to figure
out what to do. &lt;/p&gt;
&lt;h2 id="tldr"&gt;TLDR&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Be explicit in your conditional import that depends on version of underlying
python or library. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;take time to write good deprecation warning with : &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;Stacklevel (=2 most of the time) &lt;/li&gt;
&lt;li&gt;Since When it was deprecated.&lt;/li&gt;
&lt;li&gt;What should replace deprecated call for consumers. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The time you put in these will greatly help your downstream consumers, and
benefit you later to simplify getting rid of lots of code easily.&lt;/p&gt;&lt;/div&gt;</description><category>best-practices</category><category>open-source</category><category>python</category><guid>https://carreau.github.io/posts/34-the-pleasure-of-deleting-code.md.html</guid><pubDate>Tue, 03 Apr 2018 13:30:00 GMT</pubDate></item><item><title>One less Pull Request</title><link>https://carreau.github.io/posts/21-one-less-pull-request.md.html</link><dc:creator>Matthias Bussonnier</dc:creator><description>&lt;div&gt;&lt;p&gt;This time of the year again, it's soon going to be the period where many
websites and organisation will push you to make contribution to Open-Source,
for example via &lt;a href="https://hacktoberfest.digitalocean.com/"&gt;hacktoberfest&lt;/a&gt; I got
a nice T-shirt last year, and &lt;a href="http://24pullrequests.com/"&gt;24pullrequests&lt;/a&gt; seem
to get tractions as well each years. Theses are really nice incentive that push
users of open-source to start contributing and already seasons developers to
try touch new project. &lt;/p&gt;
&lt;p&gt;Here is a request I got for you whether you participate or not to these events:
Please close a Pull Request. &lt;/p&gt;
&lt;h2 id="less-is-more"&gt;Less is More&lt;/h2&gt;
&lt;p&gt;While I really appreciate having new contributions, there is a point were too
many opened pull-requests can &#8211;&#160;I think &#8211; be harmful. I'm going to expose the
various case, why I think these are harmful and what can be done.&lt;/p&gt;
&lt;p&gt;Here are two specific examples : the &lt;a href="https://github.com/sympy/sympy"&gt;Sympy
Project&lt;/a&gt; (as &lt;a href="https://twitter.com/asmeurer/status/780512119024410625"&gt;Aaron feel
targeted&lt;/a&gt;), the authors
are absolutely extraordinary and reactive. The current count of opened PR is
378. &lt;a href="https://github.com/matplotlib/matplotlib"&gt;Matplotlib&lt;/a&gt; is also apparently
at &lt;a href="https://twitter.com/tacaswell/status/780508160490692609"&gt;207&lt;/a&gt;. You can see
in the discussion linked here that maintainers feel differently about high
number of PRs.&lt;/p&gt;
&lt;h3 id="i-open-to-many-pull-requests"&gt;I open to many pull requests&lt;/h3&gt;
&lt;p&gt;I currently have 12 opened pull requests, see how many &lt;a href="https://github.com/pulls"&gt;you
have&lt;/a&gt;. This mean that I (at least) have to follow-up
with around 12 projects every days. This is an extremely hight cognitive cost
of switching. I try to not keep a PR older than 6 month. If it's older then
it's most likely not going to be merged or taken care of by the maintainers.
Every time I get to this screen I at least spend 30 sec wondering what to do
about old PRs.&lt;/p&gt;
&lt;p&gt;My advice is to stay focus: If you are not going to work on a Pull Request, let
the maintainers know about this fact: close it. It can still be reopened. You
might want to leave a message explaining why you are not working on it, and
that you would be happy (or not), for someone else to take over.&lt;/p&gt;
&lt;p&gt;I'm now back to 8. It fits on one screen, I can be more focused.&lt;/p&gt;
&lt;p&gt;Also if you are a maintainer and know a pull-request will likely not get
merged, I would prefer you don't give me false hope, and close it. Explain why.
Even if it's just that's you are busy on something else and would appreciate if
this was resubmitted later. I'm more likely to get over it and try a few other
time than if my first contribution got no responses.&lt;/p&gt;
&lt;h3 id="i-receive-too-many-pull-requests"&gt;I receive too many pull-requests&lt;/h3&gt;
&lt;p&gt;I strongly encourage you to try
&lt;a href="https://minrk.github.io/all-my-pulls/"&gt;minrk.github.io/all-my-pulls&lt;/a&gt; it allows
you to view all the pull-requests you have the ability to merge. And filter by
repositories you do not wish to see. After filtering, I have 61 pull requests
in 19 repos. It is too much to stay focused as well.&lt;/p&gt;
&lt;p&gt;Many of these pull-requests have stalled, and I would gladly appreciate for the
authors to close them if they have no intention on working on things. To be
honest many of the oldest pull-requests have entered this "Awkward state" of
wanting to close it but not actually doing so because it can be rough for the
author to see his work dismiss. &lt;/p&gt;
&lt;p&gt;As a maintainer I should do a better job as saying when a Pull request have
stalled and is just polluting the PR list. Close it with a nice explanation.
It's always possible to reopen if needed. GitHub allows canned responses, I use
it as a template to list the policy of PR closing. I've found that &lt;a href="http://jupyter.readthedocs.io/en/latest/development_guide/closing_prs.html"&gt;having a
clear
policy&lt;/a&gt;
often make decision easier. And sometime closing even allow work to be
resubmitted, to appear on the top of the pile, and start anew.&lt;/p&gt;
&lt;p&gt;There is also the possibility of taking over the author work and finishing up
in a separate PR, or push directly on authors forks if he is allowing it. I
personally rarely do that, as I feel like it is a slippery slope for the
maintainer to do everything.&lt;/p&gt;
&lt;p&gt;I find myself much more efficient when there is only 5 to 6 opened
pull-requests. I can keep track of each of them, judge whether or not the work
will conflict and give proper care to each of these. I fail to do so when there
are many pages. &lt;/p&gt;
&lt;h3 id="i-dont-contribute-to-repository-that-have-too-many-prs"&gt;I don't contribute to repository that have too many PRs.&lt;/h3&gt;
&lt;p&gt;When I come across a repository with more than 20-ish pull-requests, I tend to
think that the authors are not responding so why bother to contribute. I know
that often these are only &lt;em&gt;impressions&lt;/em&gt; and I can get over it because &lt;em&gt;I have
the chance&lt;/em&gt; to often know the maintainers. This feeling is though hard to get
over on repositories I'm new to.&lt;/p&gt;
&lt;p&gt;With a high number of opened PRs, I tend to also be discouraged at searching
whether someone is fixing the bug I saw, or implementing the feature I wish.
Moreover the higher the number of opened PRs the more chance there is for the
maintainers to review my PR in a long time, and the higher chance there will be
that I will need to &lt;a href="https://git-scm.com/docs/git-rebase"&gt;rebase&lt;/a&gt; my work,
which regardless of whether you are a git master &lt;a href="https://xkcd.com/1597/"&gt;or
not&lt;/a&gt; can be painful process to go through (and to ask
someone to go through).&lt;/p&gt;
&lt;p&gt;I'm pretty certain I'm not the only one to be discouraged from seeing a large
number of open non active Pull requests. I've
&lt;a href="https://twitter.com/Mbussonn/status/780474037977751552"&gt;asked&lt;/a&gt; on twitter and
it looks like roughly every other respondent are discouraged to contribute if
too many PR are opened.&lt;/p&gt;
&lt;h2 id="what-do-you-think"&gt;What do you think ?&lt;/h2&gt;
&lt;p&gt;The above paragraphs are my though on too many opened pull-requests ? How are
you feeling about that ? As you might have read in the twitter conversation
linked to above, different people have different opinions.&lt;/p&gt;
&lt;p&gt;If you want to comment, please open an &lt;a href="https://github.com/Carreau/posts/issues"&gt;issue on
GitHub&lt;/a&gt;, and if you have the courage
to help improve my English feel free to send me a PR (sic) to make this more
readable.&lt;/p&gt;
&lt;h2 id="close-a-pr"&gt;Close a PR !&lt;/h2&gt;
&lt;p&gt;Thanks you for reading up until here ! If you want to restore part of the
sanity of some maintainers, or want to appeal a bit more to some users, please
go close a PRs ! Or help finish a Pr that have stalled ! I can't give you a
free T-shirt like for HactoberFest but feel free to tweet with hashtag
&lt;code&gt;#IClosedAPR&lt;/code&gt; !&lt;/p&gt;&lt;/div&gt;</description><category>open-source</category><category>python</category><guid>https://carreau.github.io/posts/21-one-less-pull-request.md.html</guid><pubDate>Mon, 26 Sep 2016 20:00:00 GMT</pubDate></item></channel></rss>