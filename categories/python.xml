<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Random Thoughts (python)</title><link>http://carreau.github.io/</link><description></description><atom:link rel="self" href="http://carreau.github.io/categories/python.xml" type="application/rss+xml"></atom:link><language>en</language><lastBuildDate>Sun, 29 Nov 2015 20:20:03 GMT</lastBuildDate><generator>https://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Planning an Early Death for Python 2</title><link>http://carreau.github.io/posts/planning-an-early-death-for-python-2.html</link><dc:creator>Matthias Bussonnier</dc:creator><description>&lt;div&gt;&lt;p&gt;On September 18 and 19, 2015, the Data Structure for Data Science workshop
gathered at UC Berkeley's BIDS [Berkeley Institute for Data Science]. It was a
productive two days of presentation, discussion and working groups — a
collaborative effort aimed at expanding what data science can do.&lt;/p&gt;
&lt;p&gt;Despite having mostly Python developers, the workshop reached out and included
members from many other programming communities (e.g., C, C++, Julia, R, etc.)
as the workshop's explicit goal was to improve cross language operability. In
particular, the goal was to enable python's scientific computing tools
(numpy, scipy, pandas, etc.) to have a consensus backbone data-structure that
would enable easier interaction with other programming languages.&lt;/p&gt;
&lt;p&gt;Out of the discussion arose a topic that has long plagued the python community
at large: code that requires legacy Python 2.7 is holding back the development
of data-science toolsets and – by extension – the progress of data science as a
whole. Python 2.7 was an important part of the history of scientific computing,
but now it should be left as part of that history. Thus, we convened a small
working group to plan a early death for Legacy Python.&lt;/p&gt;
&lt;h3&gt;Move over Legacy Python once and for all.&lt;/h3&gt;
&lt;p&gt;In collaboration with many developers among whom @jiffyclub, @tacasswell,
@kbarbary, @teoliphant, @pzwang, @ogrisel, we discussed different options to
push Legacy Python more or less gently through the door. We understand that
some people are still requiring the use of Legacy Python in their code base, or
the use some libraries which are still only available on Legacy Python and we
don't blame them.  We understand that Legacy Python was a great language and
that it's hard to move over it.  Though the retirement of Legacy Python is
2020, you will ave to make the transition then, and it will be even harder to
transition at that point.&lt;/p&gt;
&lt;p&gt;So what are the step we can do to push the transition forward.&lt;/p&gt;
&lt;h3&gt;Choose your words.&lt;/h3&gt;
&lt;p&gt;The choice of words you make on the internet and in real life will influence
the vision people have for Legacy Python vs Python. Assume that Python 3 is
just Python, and refer to Python 2 as legacy python.  IDEs and TwitterSphere is
&lt;a href="https://twitter.com/astrofrog/status/646976176657932288"&gt;starting&lt;/a&gt; to &lt;a href="https://twitter.com/almarklein/status/645542438937980929"&gt;do
that&lt;/a&gt;, join the
movement.&lt;/p&gt;
&lt;p&gt;Refer to Legacy Python in the past tense. It will reinforce the old and
deprecated state of Legacy Python. I still don't understand why people would
like to stay with a language which that many defects:&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;it did not protect you from mixing Unicode and bytes,&lt;/li&gt;
&lt;li&gt;tripped you with integer division&lt;/li&gt;
&lt;li&gt;did not allow you to replace the printing function&lt;/li&gt;
&lt;li&gt;had a range object which is not memory efficient&lt;/li&gt;
&lt;li&gt;did not permit to re-raise exception&lt;/li&gt;
&lt;li&gt;had a bad asynchronous support, without yield from&lt;/li&gt;
&lt;li&gt;forced you to repeat the current class in &lt;code&gt;super()&lt;/code&gt; call.&lt;/li&gt;
&lt;li&gt;let you mix tab and space.&lt;/li&gt;
&lt;li&gt;did not support function annotations&lt;/li&gt;
&lt;/ul&gt;&lt;p&gt;Legacy Python was missing many other feature which are now part of Python.&lt;/p&gt;
&lt;p&gt;Do not state what's better in Python 3, state that it was missing/broken in
Legacy Python.  Like the missing matrix multiplication operator was missing
multiplication operator. Legacy Python was preventing people to use efficient
numeric library which are relying on the numerical operator.&lt;/p&gt;
&lt;h3&gt;Don't respond to "and on Python 2"&lt;/h3&gt;
&lt;p&gt;Personally during talks I plan to not pay attention to question regarding
legacy Python, and will treat questions such questions as someone asking whether
I support windows Vista. Next question please. The less you talk about Legacy Python
the more you imply Legacy Python  is not a thing anymore.&lt;/p&gt;
&lt;h3&gt;Drop support for Legacy Python (at least on paper)&lt;/h3&gt;
&lt;p&gt;If you a library author, you have probably had to deal with user trying your
software on Legacy Python, and spend lot of time making your codebase
compatible with both Python 3 and legacy Python.  There are a few step you can
take to push user toward Python 3.&lt;/p&gt;
&lt;p&gt;If a user is not willing to update to a new version on Python, and decide to stay on
legacy Python, they can most likely pin the version on your library to versions which
support Legacy Python.&lt;/p&gt;
&lt;h4&gt;Make your examples/documentation Python 3 only&lt;/h4&gt;
&lt;p&gt;Or at least do not make effort to have examples that work using Legacy Python.
Sprinkle with function annotation, and &lt;code&gt;async&lt;/code&gt;/&lt;code&gt;await&lt;/code&gt; keyword can help with
communicating your example are Python 3 only.&lt;/p&gt;
&lt;p&gt;You can even avoid mention of Legacy Python in your documentation and assume
your users are using Python 3, this will make writing documentation much easier,
and increase the chances to get examples right.&lt;/p&gt;
&lt;h4&gt;Ask user to reproduce but on up-to-date Python version.&lt;/h4&gt;
&lt;p&gt;Have you ever had a bug report where you ask users to upgrade your libraries
dependencies ? Do the same with Python. If a user make a bug report with Python
2.7 ask them if they can reproduce with an up-to date version of Python, even
if the bug is obviously from your side.  If they really can't upgrade they will
know, if they do and can reproduce, then you'll have at least converted one
user from Legacy Python (and in the meantime you might have already corrected
the bug).&lt;/p&gt;
&lt;h4&gt;Defer 2.7 support to companies like Continuum&lt;/h4&gt;
&lt;p&gt;This is already what &lt;a href="http://www.curiousefficiency.org/posts/2015/04/stop-supporting-python26.html"&gt;Nick Coghlan
recommands&lt;/a&gt;
for Python 2.6, and that's what you can do for Legacy Python fix. If you
have a sufficient number of user which are asking for 2.7 support, accept the
bug report, but as an open source maintainer do not work on it. You can partner
with companies like Continuum or Enthought, from which user would "buy" 2.7 support
for your libraries, in exchange of which the Companies could spend some of their
developer time fixing your Legacy Python bugs.&lt;/p&gt;
&lt;p&gt;After a quick discussion with Peter Wang, it would be possible, but details
need to be worked on.&lt;/p&gt;
&lt;h3&gt;Make Python 3 attractive&lt;/h3&gt;
&lt;h4&gt;Create new features&lt;/h4&gt;
&lt;p&gt;Plan you new features explicitly for Python 3, even if the feature would be
simple to make Legacy Python compatible, disable it on old platforms, and issue
a warning indicating that the feature is not available on Legacy Python
install.&lt;/p&gt;
&lt;p&gt;You will be able to use all the shiny Python features which are lacking on
Legacy Python like Unicode characters !&lt;/p&gt;
&lt;h4&gt;Create new Python packages&lt;/h4&gt;
&lt;p&gt;Make new packages Python 3 only, and make all the design decision you didn't do
on your previous package. Pure python libraries are much easier to create and
&lt;a href="http://flit.readthedocs.org/en/latest/"&gt;build&lt;/a&gt;  once you are not hold back by
legacy Python.&lt;/p&gt;
&lt;h3&gt;Helping Other project&lt;/h3&gt;
&lt;p&gt;Despite all the good will in the world the Migration path from Legacy Python
can be hard.  There are still a lot of things that can be done to help current
and new project to push forward the adoption of Python.&lt;/p&gt;
&lt;h4&gt;Testing&lt;/h4&gt;
&lt;p&gt;Make sure that all the project you care about have continuous integration on
Python 3, if possible even the documentation building done with Python 3, help
to make Python 3 the default.&lt;/p&gt;
&lt;p&gt;With continuous integration, check that your favorites projects are tested on
Python Nightly, most CI provider allow the tests to be ran on nightly, but do
not make the status of the project turn red if the test are failing. See
&lt;a href="http://docs.travis-ci.com/user/customizing-the-build/#Rows-that-are-Allowed-to-Fail"&gt;&lt;code&gt;allow_faillure&lt;/code&gt;&lt;/a&gt;
on Travis-CI for example.&lt;/p&gt;
&lt;h4&gt;Porting C-extensions, move to Cython&lt;/h4&gt;
&lt;p&gt;The path to migrate C-extension is not well documented, the preferred approach
is to use &lt;a href="https://cffi.readthedocs.org/en/latest/"&gt;CFFI&lt;/a&gt;, but there is still
alack of well written centralised, document on how to integrate with Python 3.
IF you are knowledgeable on this domain, your help is welcomed.&lt;/p&gt;
&lt;h3&gt;The things we will (probably) not do.&lt;/h3&gt;
&lt;p&gt;Make a twitter account that shame people that use Legacy Python, though we
might do a Parody account which say funny things, and push people toward Python 3.&lt;/p&gt;
&lt;p&gt;Slow code on purpose and obviously on Legacy Python:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;version_info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
    &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Though it would be fun.&lt;/p&gt;
&lt;p&gt;Ask user at IDE/CLI startup time if they want to upgrade to Python3:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;python2
Python 2.7.10 &lt;span class="o"&gt;(&lt;/span&gt;default, Jul &lt;span class="m"&gt;13&lt;/span&gt; 2015, 12:05:58&lt;span class="o"&gt;)&lt;/span&gt;
Type &lt;span class="s2"&gt;"help"&lt;/span&gt;, &lt;span class="s2"&gt;"copyright"&lt;/span&gt;, &lt;span class="s2"&gt;"credits"&lt;/span&gt; or &lt;span class="s2"&gt;"license"&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; more information.

Warning you are starting a Legacy Python interpreter. Aren&lt;span class="s1"&gt;'t you sure you don'&lt;/span&gt;t
want not to upgrade to a newer version ? &lt;span class="o"&gt;[&lt;/span&gt;y&lt;span class="o"&gt;]&lt;/span&gt;:_
&lt;/pre&gt;


&lt;p&gt;Delay Legacy Python packages releases by a few weeks to incentive people to
migrate, or should we actually consider the people on Python 2 as guinea pig
and release nightly ?&lt;/p&gt;
&lt;h2&gt;End word&lt;/h2&gt;
&lt;p&gt;Remember, Legacy Python is responsible for global warming, encourage people to
stay with IE6, and is voting for Donald Trump.&lt;/p&gt;
&lt;p&gt;If you have any ideas, please send me a Pull Request, I'll be happy to discuss. &lt;/p&gt;
&lt;p&gt;As usual my English is far from perfect, so Pull Request welcomed on this blog
post. Thanks to @michaelpacer who already did some rereading/rephrasing of
first draft.&lt;/p&gt;&lt;/div&gt;</description><category>python</category><guid>http://carreau.github.io/posts/planning-an-early-death-for-python-2.html</guid><pubDate>Thu, 24 Sep 2015 10:00:00 GMT</pubDate></item></channel></rss>